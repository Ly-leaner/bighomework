# 大作业第三次修改项目说明
## 一、新增和完善的类和功能
1、新增了游戏开始界面类（startWindow），继承QPushButton得到的按钮类（myPushButton），继承自敌人1的敌人2类（enemy2）、继承自炮塔1的炮塔2类（tower2），修改后的UML类图如下：
![image](https://raw.githubusercontent.com/Ly-leaner/bighomework/master/UML-3.png)

2、更改后的函数调用基本流程图如下：
![image](https://raw.githubusercontent.com/Ly-leaner/bighomework/master/process-3.png)

3、增加了游戏背景音乐，安置塔基、防御塔以及敌人被消灭，基地受到攻击的音效。

4、MainWindow窗口的优化，在打开程序时增加进入游戏的初始化界面，在游戏过程中增加游戏暂停按钮，在游戏结束后增加重新开始和退出按钮。

##二、游戏总体设计
&emsp;&emsp;游戏设计中的主要类包括：游戏开始界面类（startWindow）、游戏主窗口类（mainWindow）、炮台类（towerPosition）、子弹类（bullet）、敌人1类（enemy）、炮塔1类（tower）、继承自敌人1的敌人2类（enemy2）、继承自炮塔2的炮塔2类（tower2）。辅助类包括：航点类（wayPoint）、继承QPushButton得到的按钮类（myPushButton）、用于读取存有炮台位置和敌人波数信息的.xml文件的plistReader类（也可以将上述信息存放在数组中而不通过plistReader类读取，在代码中已将用数组实现的方式用注释的形式标出）以及一个只含有头文件的公共函数类（utilityFunction），该类中只含有一个碰撞检测函数，为方便其他类的调用，在头文件中同时包含了函数的声明和定义。
	
&emsp;&emsp;程序运行时，在main函数中生成游戏开始界面类的对象，游戏开始界面类中组合了游戏主窗口类的对象，通过添加开始按钮并利用Qt信号和槽机制调用游戏主界面类对象的函数，开始游戏。游戏中敌人、子弹的移动以及炮塔的安装、拆除通过在游戏主窗口界面类中重写绘图事件、鼠标事件并通过QTimer计时器对游戏场景定时更新来实现。游戏住窗口类中组合或使用了上述各类，使用QList列表类对航点类、炮台类、炮塔类、敌人类、子弹类对象以及敌人波数信息进行管理，并将这些列表添加为主窗口类的私有属性以达到封装和保护的目的。程序中主要函数的调用流程将在图片2中给出，此处不再赘述。

##三、游戏规则说明
&emsp;&emsp;游戏中的基本操作为鼠标操作：通过单击鼠标左键来安装第一类炮塔（慢炮）；单击鼠标右键来安装第二类炮塔（快炮）；双击鼠标左键来拆除炮塔。在规则上，游戏初始化为玩家配置了1000金币，每安装一个第一类炮塔需要消耗300金币，安装第二类炮塔需消耗600金币，消灭轨道上的一个敌人可以获得200金币奖励；游戏中共设计了三波敌人，敌人的移动速度与敌人的波数成正相关，敌人分为第一类敌人和第二类敌人，第二类比第一类有更多的血量（第一类的血量为5，第二类的血量为10）并且移动更快，炮塔每攻击一次所造成的伤害值为1；基地的初始化HP（hit point）为3。

## 三、未完善的功能
1、游戏关卡选择。

2、敌人对防御塔的攻击能力。
